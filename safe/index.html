<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dynamic Rectangle Height</title>
  <link rel="manifest" href="/manifest.json">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="icon-192x192.png">
  <meta name="theme-color" content="#b25a7c">
  <meta name="apple-mobile-web-app-status-bar-style" content="#b25a7c">
  <style>
    html {
      font-size: .254237288vw; /* Set base font-size for rem calculations. */
    }

    body, .safe {
      margin: 0;
      padding: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      align-items: center;
    }

    .visually-hidden {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      border: 0;
    }

    .rectangle {
      width: 100vw;
      background-color: black; /* Set rectangle to black for high contrast. */
    }

    button {
      padding: 0.5rem;
    }

    input[type="number"] {
      pointer-events: none; /* Make the input field uneditable. */
    }
  </style>
</head>
<body>

<div class="safe">
  <form id="controlForm">
    <label class="visually-hidden" for="unitSelect">Select Unit:</label>
    <select id="unitSelect">
      <option value="px">Px</option>
      <option value="vh">Vh</option>
      <option value="vw">Vw</option>
      <option value="rem">Rem</option>
    </select>

    <label class="visually-hidden" for="heightInput">Height:</label>
    <input type="number" id="heightInput" value="56" readonly />

    <button type="button" id="ui">ui</button>
    <button type="button" id="di">di</button>
    <button type="button" id="ud">ud</button>
    <button type="button" id="dd">dd</button>
  </form>

  <div id="rectangle" class="rectangle"></div>
</div>

<script>
  const unitSelect = document.getElementById('unitSelect');
  const heightInput = document.getElementById('heightInput');
  const rectangle = document.getElementById('rectangle');
  const buttons = {
    ui: document.getElementById('ui'),
    di: document.getElementById('di'),
    ud: document.getElementById('ud'),
    dd: document.getElementById('dd')
  };

  // Detect platform based on user agent
  let platform;
  if (/android/i.test(navigator.userAgent)) {
    platform = 'android';
  } else if (/iPhone|iPad|iPod/i.test(navigator.userAgent)) {
    platform = 'ios';
  } else {
    platform = 'unknown';
  }

  // Object to store user-defined values for each platform and unit.
  const unitValues = {
    ios: {
      px: 108.2,
      vh: 14,
      vw: 27.6,
      rem: 108.3
    },
    android: {
      px: 56.3,
      vh: 6.5,
      vw: 13.1,
      rem: 51.2
    },
    unknown: {
      px: 50, // Default values for unknown platforms
      vh: 10,
      vw: 10,
      rem: 50
    }
  };

  // Function to update the rectangle height based on user input.
  function updateRectangleHeight() {
    const selectedUnit = unitSelect.value;
    const heightValue = heightInput.value;
    rectangle.style.height = `${heightValue}${selectedUnit}`;
  }

  // Function to set default or user-defined value based on the detected platform.
  function setDefaultHeight() {
    const selectedUnit = unitSelect.value;
    heightInput.value = unitValues[platform][selectedUnit];
    updateRectangleHeight();
  }

  // Update stored values when buttons are clicked, keeping decimals.
  buttons.ui.addEventListener('click', () => {
    heightInput.value = (parseFloat(heightInput.value) + 1).toFixed(1);
    unitValues[platform][unitSelect.value] = parseFloat(heightInput.value);
    updateRectangleHeight();
  });

  buttons.di.addEventListener('click', () => {
    heightInput.value = (parseFloat(heightInput.value) - 1).toFixed(1);
    unitValues[platform][unitSelect.value] = parseFloat(heightInput.value);
    updateRectangleHeight();
  });

  buttons.ud.addEventListener('click', () => {
    heightInput.value = (parseFloat(heightInput.value) + 0.1).toFixed(1);
    unitValues[platform][unitSelect.value] = parseFloat(heightInput.value);
    updateRectangleHeight();
  });

  buttons.dd.addEventListener('click', () => {
    heightInput.value = (parseFloat(heightInput.value) - 0.1).toFixed(1);
    unitValues[platform][unitSelect.value] = parseFloat(heightInput.value);
    updateRectangleHeight();
  });

  // Update the height when the unit changes.
  unitSelect.addEventListener('change', setDefaultHeight);

  // Set initial height.
  setDefaultHeight();
</script>

</body>
</html>
